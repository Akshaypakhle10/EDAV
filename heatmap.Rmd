# Chart: Heatmap {#heatmap}

<!-- Chapter Banner -->
![](images/banners/banner_heatmap.png)


<!-- Under Construction Section
----------------------------------------------------------------------------- -->
![Under Construction](images/banners/banner_under_construction.png)
*This page is a work in progress. We appreciate any input you may have. If you would like to help improve this page, consider [contributing to our repo](contribute.html).*
<!-- ------------------------------------------------------------------------ -->

## Overview

This section covers how to make heatmaps.

## tl;dr

[Coming soon <i class="far fa-smile-beam"></i>](https://www.youtube.com/watch?v=7kdV8VmD76w){target="_blank"}

## Simple examples

Too complicated! [Simplify, man!](https://www.youtube.com/watch?v=PlsW2hd06R0){target="_blank"}

For these heat maps, we will use the `SpeedSki` dataset.

### Heat map of two-dimensional bin counts

Only two variables, `x` and `y` are needed for two-dimensional bin count heat maps. The third variable--i.e., the color--represents the bin count of points in the region it covers. Think of it as a two-dimensional histogram.

To create a heat map, simply substitute `geom_point()` with `geom_bin2d()`:
```{r heat-map-default}
library(ggplot2) # plotting 
library(GDAdata) # data (SpeedSki)

ggplot(SpeedSki, aes(Year, Speed)) + 
  geom_bin2d()
```

### Heat map of dataframe

To get a visual sense of the dataframe, you can use a heatmap. You can also look into normalizing columns to get a sense of your data on a common scale. In this example, we use `geom_tile` to graph all cells in the dataframe and color them by their value:
```{r heat-map-wine, message=FALSE}
library(pgmm) # data
library(tidyverse) # processing/graphing
library(viridis) # color palette

data(wine)

# convert to column, value
wine_new <- wine %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

ggplot(wine_new, aes(x = rowname, y = colname, fill = value)) +
  geom_tile() + scale_fill_viridis() +
  ggtitle("Italian Wine Dataframe")
```

```{r}
# only difference from above is scaling
wine_scaled <- data.frame(scale(wine)) %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

ggplot(wine_scaled, aes(x = rowname, y = colname, fill = value)) +
  geom_tile() + scale_fill_viridis() +
  ggtitle("Italian Wine Dataframe, Scaled")
```

### Modifications

You can change the color palette by specifying it explicitly in your chain of `ggplot` function calls. The bin width can be added inside the `geom_bin2d()` function call:
```{r heat-map-color-bin-width, message=FALSE}
library(viridis) # viridis color palette

# create plot
g1 <- ggplot(SpeedSki, aes(Year, Speed)) + 
  scale_fill_viridis() # modify color

# show plot
g1 + geom_bin2d(binwidth = c(5, 5)) # modify bin width
```

Here are some other examples:
```{r}
# larger bin width
g1 + geom_bin2d(binwidth = c(10, 10)) 
```

```{r}
# hexagonal bins
g1 + geom_hex(binwidth = c(5, 5))
```

```{r}
# hexagonal bins + scatterplot layer
g1 + geom_hex(binwidth = c(5, 5), alpha = .4) + 
  geom_point(size = 2, alpha = 0.8)
```

```{r}
# hexagonal bins with custom color gradient/bin count
ggplot(SpeedSki, aes(Year, Speed)) + 
  scale_fill_gradient(low = "#cccccc", high = "#09005F") + # color
  geom_hex(bins = 10) # number of bins horizontally/vertically
```

## Theory

Heat maps are like a combination of [scatterplots](scatter.html) and [histograms](histo.html): they allow you to compare different parameters while also seeing their relative distributions.

*   While heatmaps are visually striking, there are often better choices to get your point across. For more info, checkout this [DataCamp section on heatmaps and alternatives](https://campus.datacamp.com/courses/data-visualization-with-ggplot2-2/chapter-4-best-practices?ex=10){target="_blank"}.

## External resources
- [R Graph Gallery: Heatmaps](https://www.r-graph-gallery.com/heatmap/){target="_blank"}: Has examples of creating heatmaps with the `heatmap()` function.
- [How to make a simple heatmap in ggplot2](https://www.r-bloggers.com/how-to-make-a-simple-heatmap-in-ggplot2/){target="_blank"}: Create a heatmap with `geom_tile()`.













